From 8c9ce98282a45f939e56531173a0760b9a49bc4e Mon Sep 17 00:00:00 2001
From: Holger Hans Peter Freyther <zecke@selfish.org>
Date: Sat, 20 Dec 2008 22:32:20 +0100
Subject: [PATCH] Write the position (x,y), the font and the glyph_index on a line

These are the positions of each glyph... this format
is easy to parse and change in the future... it will be
the base of finding a good encoding that is not bigger
than then original text file but still contains the layout
information.
---
 WebKitTools/GtkLauncher/main.c |   17 +++++++++++++++++
 1 files changed, 17 insertions(+), 0 deletions(-)

diff --git a/WebKitTools/GtkLauncher/main.c b/WebKitTools/GtkLauncher/main.c
index 881d85f..d4247d3 100644
--- a/WebKitTools/GtkLauncher/main.c
+++ b/WebKitTools/GtkLauncher/main.c
@@ -147,9 +147,26 @@ static void create_font_dirs(GList *glyphs)
 /*
  * Write out the text....
  */
+static void append_glyph(WebKitGlyph* glyph, GString* string)
+{
+    g_string_append_printf(string, "%d,%d,%s,%d\n",
+                           glyph->x, glyph->y,
+                           glyph->face_and_config, glyph->glyph_index);
+}
+
 static void create_text_file(GList *glyphs)
 {
+    GString* string = g_string_new(NULL); 
+    g_list_foreach(glyphs, (GFunc)append_glyph, string);
+
+    GError* error = NULL;
+    g_file_set_contents("render_text.blib", string->str, string->len, &error);
+    if (error) {
+        g_warning("Failed to write the glyphs...");
+        g_error_free(error);
+    }
 
+    g_string_free(string, TRUE);
 }
 
 static void create_links(GList *links)
-- 
1.5.6.3

